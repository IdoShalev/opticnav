<html>
<head>
<script type="text/javascript" src="jquery-2.1.0.min.js"></script>
<script src="sonic.js"></script>
<script>
/* The spinning animation is an HTML5 canvas that draws the spinner.
 * It's generated by another library (not written by us!) */
function waiting_start(elem) {
    if (elem.data("spinner") == undefined) {
        var spinner = new Sonic({
	        width: 50,
	        height: 50,

	        stepsPerFrame: 6,    // best between 1 and 5
	        trailLength: 0.9,    // between 0 and 1
	        pointDistance: 0.01, // best between 0.01 and 0.05
	        fps: 30,

	        fillColor: '#66D9EF',

	        path: [
		        ['arc', 50, 50, 30, 0, 360]
	        ],

	        step: function(point, index, frame) {

		        // Here you can do custom stuff.
		        // `this._` is a HTML 2d Canvas Context

		        var sizeMultiplier = 10; // try changing this :)
		
		        // Add frame number in lower-left corner
		        //this._.fillText(0|frame*this.fps, 1, 99);
		
		        this._.beginPath();
		        this._.moveTo(point.x, point.y);
		        this._.arc(
			        point.x/2, point.y/2,
			        index * sizeMultiplier/2, 0,
			        Math.PI*2, false
		        );
		        this._.closePath();
		        this._.fill();

	        }

        });

        elem.data("spinner", spinner);
        elem.append(spinner.canvas);
    }
    elem.data("spinner").play();
    elem.fadeIn(500);
}

function waiting_finish(elem) {
    setTimeout(function() { elem.data("spinner").stop();}, 500);
    elem.fadeOut(500);
}

function doSomething() {
    waiting_start($("#waiting1"));
    setTimeout(function() {
        waiting_finish($("#waiting1"));
    }, 2000);
}
</script>
<style>
.waiting {
    display: none;
}
</style>
</head>

<body>
<a href="javascript:doSomething();">Do something!</a>
<br/>
<span class="waiting" id="waiting1"></span>
</body>

</html>

